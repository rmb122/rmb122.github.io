<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>从一道 CTF 题了解密码学中的 Meet-in-the-middle 攻击 - rmb122's notebook</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="本文首发于先知
在家里无聊打了 nullcon, 其中有一题用到了 Meet-in-the-middle 这种攻击方式,
在这里分享给大家."><meta property="og:image" content><meta property="og:title" content="从一道 CTF 题了解密码学中的 Meet-in-the-middle 攻击"><meta property="og:description" content="本文首发于先知
在家里无聊打了 nullcon, 其中有一题用到了 Meet-in-the-middle 这种攻击方式,
在这里分享给大家."><meta property="og:type" content="article"><meta property="og:url" content="https://rmb122.com/2019/03/25/%E4%BB%8E%E4%B8%80%E9%81%93-CTF-%E9%A2%98%E4%BA%86%E8%A7%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84-Meet-in-the-middle-%E6%94%BB%E5%87%BB/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-03-25T23:26:21+00:00"><meta property="article:modified_time" content="2019-03-25T23:26:21+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="从一道 CTF 题了解密码学中的 Meet-in-the-middle 攻击"><meta name=twitter:description content="本文首发于先知
在家里无聊打了 nullcon, 其中有一题用到了 Meet-in-the-middle 这种攻击方式,
在这里分享给大家."><script src=https://rmb122.com/js/feather.min.js></script><link rel=stylesheet type=text/css media=screen href=https://rmb122.com/css/main.e9aac7e7a771269044e258ce034f7420b431b95683d4aef0faa4d381efbb16d3.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://rmb122.com/css/dark.4d342f24ad49bb75f14c3b92c9454fe693d293fb7474ecc40a101a8ad6af9d71.css disabled></head><body><div class=content><header><div class=main><a href=https://rmb122.com/>rmb122's notebook</a></div><nav><a href=/>首页</a>&nbsp;
<a href=/posts>归档</a>&nbsp;
<a href=/tags>标签</a>&nbsp;
<a href=/links>友链</a>&nbsp;
<a href=/about>关于</a>
| <a id=dark-mode-toggle onclick=toggleTheme() href></a><script src=https://rmb122.com/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>从一道 CTF 题了解密码学中的 Meet-in-the-middle 攻击</h1><div class=meta>发表于 2019 年 3 月 25 日</div></div><section class=body><p>本文首发于<a href=https://xz.aliyun.com/t/4056 title rel="noopener nofollow noreferrer" target=_blank>先知</a></p><p>在家里无聊打了 nullcon, 其中有一题用到了 <code>Meet-in-the-middle</code> 这种攻击方式,<br>在这里分享给大家.</p><h2 id=题目>题目</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>24 bit key space is brute forceable so how about 48 bit key space? flag is hackim19{decrypted flag}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>16 bit plaintext: b&#39;0467a52afa8f15cfb8f0ea40365a6692&#39; flag: b&#39;04b34e5af4a1f5260f6043b8b9abb4f8&#39;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>from</span> hashlib <span style=color:#ff79c6>import</span> md5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#ff79c6>from</span> binascii <span style=color:#ff79c6>import</span> hexlify, unhexlify
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#ff79c6>from</span> secret <span style=color:#ff79c6>import</span> key, flag
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>BLOCK_LENGTH <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>KEY_LENGTH <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>ROUND_COUNT <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>sbox <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>210</span>, <span style=color:#bd93f9>213</span>, <span style=color:#bd93f9>115</span>, <span style=color:#bd93f9>178</span>, <span style=color:#bd93f9>122</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>94</span>, <span style=color:#bd93f9>164</span>, <span style=color:#bd93f9>199</span>, <span style=color:#bd93f9>230</span>, <span style=color:#bd93f9>237</span>, <span style=color:#bd93f9>248</span>, <span style=color:#bd93f9>54</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>        <span style=color:#bd93f9>217</span>, <span style=color:#bd93f9>156</span>, <span style=color:#bd93f9>202</span>, <span style=color:#bd93f9>212</span>, <span style=color:#bd93f9>177</span>, <span style=color:#bd93f9>132</span>, <span style=color:#bd93f9>36</span>, <span style=color:#bd93f9>245</span>, <span style=color:#bd93f9>31</span>, <span style=color:#bd93f9>163</span>, <span style=color:#bd93f9>49</span>, <span style=color:#bd93f9>68</span>, <span style=color:#bd93f9>107</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>        <span style=color:#bd93f9>91</span>, <span style=color:#bd93f9>251</span>, <span style=color:#bd93f9>134</span>, <span style=color:#bd93f9>242</span>, <span style=color:#bd93f9>59</span>, <span style=color:#bd93f9>46</span>, <span style=color:#bd93f9>37</span>, <span style=color:#bd93f9>124</span>, <span style=color:#bd93f9>185</span>, <span style=color:#bd93f9>25</span>, <span style=color:#bd93f9>41</span>, <span style=color:#bd93f9>184</span>, <span style=color:#bd93f9>221</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        <span style=color:#bd93f9>63</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>42</span>, <span style=color:#bd93f9>28</span>, <span style=color:#bd93f9>104</span>, <span style=color:#bd93f9>56</span>, <span style=color:#bd93f9>155</span>, <span style=color:#bd93f9>43</span>, <span style=color:#bd93f9>250</span>, <span style=color:#bd93f9>161</span>, <span style=color:#bd93f9>22</span>, <span style=color:#bd93f9>92</span>, <span style=color:#bd93f9>81</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>        <span style=color:#bd93f9>201</span>, <span style=color:#bd93f9>229</span>, <span style=color:#bd93f9>183</span>, <span style=color:#bd93f9>214</span>, <span style=color:#bd93f9>208</span>, <span style=color:#bd93f9>66</span>, <span style=color:#bd93f9>128</span>, <span style=color:#bd93f9>162</span>, <span style=color:#bd93f9>172</span>, <span style=color:#bd93f9>147</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>74</span>, <span style=color:#bd93f9>15</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        <span style=color:#bd93f9>151</span>, <span style=color:#bd93f9>227</span>, <span style=color:#bd93f9>247</span>, <span style=color:#bd93f9>114</span>, <span style=color:#bd93f9>47</span>, <span style=color:#bd93f9>53</span>, <span style=color:#bd93f9>203</span>, <span style=color:#bd93f9>170</span>, <span style=color:#bd93f9>228</span>, <span style=color:#bd93f9>226</span>, <span style=color:#bd93f9>239</span>, <span style=color:#bd93f9>44</span>, <span style=color:#bd93f9>119</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>        <span style=color:#bd93f9>123</span>, <span style=color:#bd93f9>67</span>, <span style=color:#bd93f9>11</span>, <span style=color:#bd93f9>175</span>, <span style=color:#bd93f9>240</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>52</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>143</span>, <span style=color:#bd93f9>88</span>, <span style=color:#bd93f9>219</span>, <span style=color:#bd93f9>188</span>, <span style=color:#bd93f9>99</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>        <span style=color:#bd93f9>82</span>, <span style=color:#bd93f9>158</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>241</span>, <span style=color:#bd93f9>78</span>, <span style=color:#bd93f9>33</span>, <span style=color:#bd93f9>108</span>, <span style=color:#bd93f9>198</span>, <span style=color:#bd93f9>85</span>, <span style=color:#bd93f9>72</span>, <span style=color:#bd93f9>192</span>, <span style=color:#bd93f9>236</span>, <span style=color:#bd93f9>129</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>        <span style=color:#bd93f9>131</span>, <span style=color:#bd93f9>220</span>, <span style=color:#bd93f9>96</span>, <span style=color:#bd93f9>71</span>, <span style=color:#bd93f9>98</span>, <span style=color:#bd93f9>75</span>, <span style=color:#bd93f9>127</span>, <span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>120</span>, <span style=color:#bd93f9>243</span>, <span style=color:#bd93f9>109</span>, <span style=color:#bd93f9>23</span>, <span style=color:#bd93f9>48</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>        <span style=color:#bd93f9>97</span>, <span style=color:#bd93f9>234</span>, <span style=color:#bd93f9>187</span>, <span style=color:#bd93f9>244</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>139</span>, <span style=color:#bd93f9>18</span>, <span style=color:#bd93f9>101</span>, <span style=color:#bd93f9>126</span>, <span style=color:#bd93f9>38</span>, <span style=color:#bd93f9>216</span>, <span style=color:#bd93f9>90</span>, <span style=color:#bd93f9>125</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>        <span style=color:#bd93f9>106</span>, <span style=color:#bd93f9>24</span>, <span style=color:#bd93f9>235</span>, <span style=color:#bd93f9>207</span>, <span style=color:#bd93f9>186</span>, <span style=color:#bd93f9>190</span>, <span style=color:#bd93f9>84</span>, <span style=color:#bd93f9>171</span>, <span style=color:#bd93f9>113</span>, <span style=color:#bd93f9>232</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>105</span>, <span style=color:#bd93f9>200</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>        <span style=color:#bd93f9>70</span>, <span style=color:#bd93f9>137</span>, <span style=color:#bd93f9>152</span>, <span style=color:#bd93f9>165</span>, <span style=color:#bd93f9>19</span>, <span style=color:#bd93f9>166</span>, <span style=color:#bd93f9>154</span>, <span style=color:#bd93f9>112</span>, <span style=color:#bd93f9>142</span>, <span style=color:#bd93f9>180</span>, <span style=color:#bd93f9>167</span>, <span style=color:#bd93f9>57</span>, <span style=color:#bd93f9>153</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>        <span style=color:#bd93f9>174</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>146</span>, <span style=color:#bd93f9>194</span>, <span style=color:#bd93f9>26</span>, <span style=color:#bd93f9>150</span>, <span style=color:#bd93f9>206</span>, <span style=color:#bd93f9>141</span>, <span style=color:#bd93f9>39</span>, <span style=color:#bd93f9>60</span>, <span style=color:#bd93f9>102</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>65</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>        <span style=color:#bd93f9>176</span>, <span style=color:#bd93f9>79</span>, <span style=color:#bd93f9>61</span>, <span style=color:#bd93f9>62</span>, <span style=color:#bd93f9>110</span>, <span style=color:#bd93f9>111</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>218</span>, <span style=color:#bd93f9>197</span>, <span style=color:#bd93f9>140</span>, <span style=color:#bd93f9>168</span>, <span style=color:#bd93f9>196</span>, <span style=color:#bd93f9>83</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>        <span style=color:#bd93f9>223</span>, <span style=color:#bd93f9>144</span>, <span style=color:#bd93f9>55</span>, <span style=color:#bd93f9>58</span>, <span style=color:#bd93f9>157</span>, <span style=color:#bd93f9>173</span>, <span style=color:#bd93f9>133</span>, <span style=color:#bd93f9>191</span>, <span style=color:#bd93f9>145</span>, <span style=color:#bd93f9>27</span>, <span style=color:#bd93f9>103</span>, <span style=color:#bd93f9>40</span>, <span style=color:#bd93f9>246</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>        <span style=color:#bd93f9>169</span>, <span style=color:#bd93f9>73</span>, <span style=color:#bd93f9>179</span>, <span style=color:#bd93f9>160</span>, <span style=color:#bd93f9>253</span>, <span style=color:#bd93f9>225</span>, <span style=color:#bd93f9>51</span>, <span style=color:#bd93f9>32</span>, <span style=color:#bd93f9>224</span>, <span style=color:#bd93f9>29</span>, <span style=color:#bd93f9>34</span>, <span style=color:#bd93f9>77</span>, <span style=color:#bd93f9>117</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>        <span style=color:#bd93f9>100</span>, <span style=color:#bd93f9>233</span>, <span style=color:#bd93f9>181</span>, <span style=color:#bd93f9>76</span>, <span style=color:#bd93f9>21</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>149</span>, <span style=color:#bd93f9>204</span>, <span style=color:#bd93f9>182</span>, <span style=color:#bd93f9>138</span>, <span style=color:#bd93f9>211</span>, <span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>231</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>        <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>238</span>, <span style=color:#bd93f9>254</span>, <span style=color:#bd93f9>252</span>, <span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>195</span>, <span style=color:#bd93f9>89</span>, <span style=color:#bd93f9>69</span>, <span style=color:#bd93f9>136</span>, <span style=color:#bd93f9>87</span>, <span style=color:#bd93f9>209</span>, <span style=color:#bd93f9>118</span>, <span style=color:#bd93f9>222</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>        <span style=color:#bd93f9>20</span>, <span style=color:#bd93f9>249</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>130</span>, <span style=color:#bd93f9>35</span>, <span style=color:#bd93f9>86</span>, <span style=color:#bd93f9>116</span>, <span style=color:#bd93f9>193</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>121</span>, <span style=color:#bd93f9>135</span>, <span style=color:#bd93f9>189</span>, <span style=color:#bd93f9>215</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>        <span style=color:#bd93f9>50</span>, <span style=color:#bd93f9>148</span>, <span style=color:#bd93f9>159</span>, <span style=color:#bd93f9>93</span>, <span style=color:#bd93f9>80</span>, <span style=color:#bd93f9>45</span>, <span style=color:#bd93f9>17</span>, <span style=color:#bd93f9>205</span>, <span style=color:#bd93f9>95</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>p <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>15</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>11</span>, <span style=color:#bd93f9>14</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>xor</span>(a, b):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(<span style=color:#8be9fd;font-style:italic>map</span>(<span style=color:#ff79c6>lambda</span> s: s[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>^</span> s[<span style=color:#bd93f9>1</span>], <span style=color:#8be9fd;font-style:italic>zip</span>(a, b)))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>fun</span>(key, pt):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(pt) <span style=color:#ff79c6>==</span> BLOCK_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(key) <span style=color:#ff79c6>==</span> KEY_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>    key <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(unhexlify(md5(key)<span style=color:#ff79c6>.</span>hexdigest()))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>    ct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(pt)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span><span>    <span style=color:#ff79c6>for</span> _ <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(ROUND_COUNT):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span><span>        ct <span style=color:#ff79c6>=</span> xor(ct, key)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(BLOCK_LENGTH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span><span>            ct[i] <span style=color:#ff79c6>=</span> sbox[ct[i]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span>        nct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(BLOCK_LENGTH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(BLOCK_LENGTH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span><span>            nct[i] <span style=color:#ff79c6>=</span> ct[p[i]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span>        ct <span style=color:#ff79c6>=</span> nct
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>    <span style=color:#ff79c6>return</span> hexlify(ct)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>toofun</span>(key, pt):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(key) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>*</span> KEY_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span><span>    key1 <span style=color:#ff79c6>=</span> key[:KEY_LENGTH]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span><span>    key2 <span style=color:#ff79c6>=</span> key[KEY_LENGTH:]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span><span>    ct1 <span style=color:#ff79c6>=</span> unhexlify(fun(key1, pt))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span><span>    ct2 <span style=color:#ff79c6>=</span> fun(key2, ct1)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span>    <span style=color:#ff79c6>return</span> ct2
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;16 bit plaintext: </span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>&#34;</span> <span style=color:#ff79c6>%</span> toofun(key, <span style=color:#f1fa8c>b</span><span style=color:#f1fa8c>&#34;16 bit plaintext&#34;</span>))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span><span><span style=color:#8be9fd;font-style:italic>print</span>(<span style=color:#f1fa8c>&#34;flag: </span><span style=color:#f1fa8c>%s</span><span style=color:#f1fa8c>&#34;</span> <span style=color:#ff79c6>%</span> toofun(key, flag))
</span></span></code></pre></div><h2 id=解题思路>解题思路</h2><p>我们的目标就是通过给出的明文 <code>16 bit plaintext</code> 和对应的密文 <code>0467a52afa8f15cfb8f0ea40365a6692</code><br>算出 key, 从而解密 flag 密文 <code>04b34e5af4a1f5260f6043b8b9abb4f8</code></p><p>根据加密代码和题目描述, 很显然方法只有爆破一种, 但是爆破 6 位 key 的 <code>2**48</code>(281,474,976,710,656) 种可能是不现实的.<br>但正如题目中所说, 爆破 <code>2**24</code>(16,777,216) 还是非常简单的.</p><p>现在我们的问题变成如何简化这个爆破过程, 这里就要用到一开始说的 <code>Meet-in-the-middle</code> 攻击,<br>加密主要是这两个函数,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>fun</span>(key, pt):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(pt) <span style=color:#ff79c6>==</span> BLOCK_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(key) <span style=color:#ff79c6>==</span> KEY_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    key <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(unhexlify(md5(key)<span style=color:#ff79c6>.</span>hexdigest()))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    ct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(pt)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>    <span style=color:#ff79c6>for</span> _ <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(ROUND_COUNT):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>        ct <span style=color:#ff79c6>=</span> xor(ct, key)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(BLOCK_LENGTH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>            ct[i] <span style=color:#ff79c6>=</span> sbox[ct[i]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>        nct <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bytearray</span>(BLOCK_LENGTH)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>        <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(BLOCK_LENGTH):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>            nct[i] <span style=color:#ff79c6>=</span> ct[p[i]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>        ct <span style=color:#ff79c6>=</span> nct
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>    <span style=color:#ff79c6>return</span> hexlify(ct)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>toofun</span>(key, pt):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>    <span style=color:#ff79c6>assert</span> <span style=color:#8be9fd;font-style:italic>len</span>(key) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>*</span> KEY_LENGTH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>    key1 <span style=color:#ff79c6>=</span> key[:KEY_LENGTH]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>    key2 <span style=color:#ff79c6>=</span> key[KEY_LENGTH:]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>    ct1 <span style=color:#ff79c6>=</span> unhexlify(fun(key1, pt))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>    ct2 <span style=color:#ff79c6>=</span> fun(key2, ct1)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>    <span style=color:#ff79c6>return</span> ct2
</span></span></code></pre></div><p>发现其实真正的加密函数是 <code>fun</code>, 在 <code>toofun</code> 中调用了两次<br>而且这里并没有将 6 位长的 key 一次性使用, 而是将其从中间分开, 先用前 3 位加密一次, 再用后 3 位加密一次.<br>也就是说实际的加密过程是用两个 3 位的 key 连续加密二次.<br>这就让我们的攻击有了可能性.</p><p>虽然也是爆破, 但是与一开始的最先能想到的爆破 6 位 key 不同的是<br>我们先遍历所有 3 位长的 key, 算出 <code>16 bit plaintext</code> 对应的所有第一次加密结果, 将其保存起来,<br>然后再遍历一次 key, 将密文解密, 如果能在第一次加密的结果中找到, 那么对应的两个 3 位 key 拼起来就是一开始的 6 位 key.<br>然后用这个 key 就可以解密出 flag 了~<br>现在能感觉到这个攻击的名字取的还是非常切题的, 一边加密, 一边解密, 在中间碰头得到秘钥.</p><p>与一开始的解法相比, 我们成功的将 <code>2**48</code> 降到 <code>2*2**24</code>, 不过对应的是需要一个哈希表来保存所有第一次加密的结果,<br>相当于用空间换时间了, 好在现在内存都比较大, 应付起来很轻松.</p><h2 id=题解>题解</h2><p>因为 python 不太适合这种大量数据的爆破, 所以就用 C++ 写了, 写的比较烂请见谅</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1</span><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&#34;md5.cpp&#34;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2</span><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;iostream&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3</span><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;unordered_map&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4</span><span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;string&gt;</span><span style=color:#ff79c6>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5</span><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6</span><span><span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> BLOCK_LENGTH <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>16</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7</span><span><span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> ROUND_COUNT <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>16</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8</span><span><span style=color:#ff79c6>typedef</span> <span style=color:#8be9fd>unsigned</span> <span style=color:#8be9fd>char</span> uchar;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10</span><span>uchar sbox[]  <span style=color:#ff79c6>=</span> {<span style=color:#bd93f9>210</span>, <span style=color:#bd93f9>213</span>, <span style=color:#bd93f9>115</span>, <span style=color:#bd93f9>178</span>, <span style=color:#bd93f9>122</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>94</span>, <span style=color:#bd93f9>164</span>, <span style=color:#bd93f9>199</span>, <span style=color:#bd93f9>230</span>, <span style=color:#bd93f9>237</span>, <span style=color:#bd93f9>248</span>, <span style=color:#bd93f9>54</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11</span><span>                 <span style=color:#bd93f9>217</span>, <span style=color:#bd93f9>156</span>, <span style=color:#bd93f9>202</span>, <span style=color:#bd93f9>212</span>, <span style=color:#bd93f9>177</span>, <span style=color:#bd93f9>132</span>, <span style=color:#bd93f9>36</span>, <span style=color:#bd93f9>245</span>, <span style=color:#bd93f9>31</span>, <span style=color:#bd93f9>163</span>, <span style=color:#bd93f9>49</span>, <span style=color:#bd93f9>68</span>, <span style=color:#bd93f9>107</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12</span><span>                 <span style=color:#bd93f9>91</span>, <span style=color:#bd93f9>251</span>, <span style=color:#bd93f9>134</span>, <span style=color:#bd93f9>242</span>, <span style=color:#bd93f9>59</span>, <span style=color:#bd93f9>46</span>, <span style=color:#bd93f9>37</span>, <span style=color:#bd93f9>124</span>, <span style=color:#bd93f9>185</span>, <span style=color:#bd93f9>25</span>, <span style=color:#bd93f9>41</span>, <span style=color:#bd93f9>184</span>, <span style=color:#bd93f9>221</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13</span><span>                 <span style=color:#bd93f9>63</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>42</span>, <span style=color:#bd93f9>28</span>, <span style=color:#bd93f9>104</span>, <span style=color:#bd93f9>56</span>, <span style=color:#bd93f9>155</span>, <span style=color:#bd93f9>43</span>, <span style=color:#bd93f9>250</span>, <span style=color:#bd93f9>161</span>, <span style=color:#bd93f9>22</span>, <span style=color:#bd93f9>92</span>, <span style=color:#bd93f9>81</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14</span><span>                 <span style=color:#bd93f9>201</span>, <span style=color:#bd93f9>229</span>, <span style=color:#bd93f9>183</span>, <span style=color:#bd93f9>214</span>, <span style=color:#bd93f9>208</span>, <span style=color:#bd93f9>66</span>, <span style=color:#bd93f9>128</span>, <span style=color:#bd93f9>162</span>, <span style=color:#bd93f9>172</span>, <span style=color:#bd93f9>147</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>74</span>, <span style=color:#bd93f9>15</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15</span><span>                 <span style=color:#bd93f9>151</span>, <span style=color:#bd93f9>227</span>, <span style=color:#bd93f9>247</span>, <span style=color:#bd93f9>114</span>, <span style=color:#bd93f9>47</span>, <span style=color:#bd93f9>53</span>, <span style=color:#bd93f9>203</span>, <span style=color:#bd93f9>170</span>, <span style=color:#bd93f9>228</span>, <span style=color:#bd93f9>226</span>, <span style=color:#bd93f9>239</span>, <span style=color:#bd93f9>44</span>, <span style=color:#bd93f9>119</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16</span><span>                 <span style=color:#bd93f9>123</span>, <span style=color:#bd93f9>67</span>, <span style=color:#bd93f9>11</span>, <span style=color:#bd93f9>175</span>, <span style=color:#bd93f9>240</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>52</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>143</span>, <span style=color:#bd93f9>88</span>, <span style=color:#bd93f9>219</span>, <span style=color:#bd93f9>188</span>, <span style=color:#bd93f9>99</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17</span><span>                 <span style=color:#bd93f9>82</span>, <span style=color:#bd93f9>158</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>241</span>, <span style=color:#bd93f9>78</span>, <span style=color:#bd93f9>33</span>, <span style=color:#bd93f9>108</span>, <span style=color:#bd93f9>198</span>, <span style=color:#bd93f9>85</span>, <span style=color:#bd93f9>72</span>, <span style=color:#bd93f9>192</span>, <span style=color:#bd93f9>236</span>, <span style=color:#bd93f9>129</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18</span><span>                 <span style=color:#bd93f9>131</span>, <span style=color:#bd93f9>220</span>, <span style=color:#bd93f9>96</span>, <span style=color:#bd93f9>71</span>, <span style=color:#bd93f9>98</span>, <span style=color:#bd93f9>75</span>, <span style=color:#bd93f9>127</span>, <span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>120</span>, <span style=color:#bd93f9>243</span>, <span style=color:#bd93f9>109</span>, <span style=color:#bd93f9>23</span>, <span style=color:#bd93f9>48</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19</span><span>                 <span style=color:#bd93f9>97</span>, <span style=color:#bd93f9>234</span>, <span style=color:#bd93f9>187</span>, <span style=color:#bd93f9>244</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>139</span>, <span style=color:#bd93f9>18</span>, <span style=color:#bd93f9>101</span>, <span style=color:#bd93f9>126</span>, <span style=color:#bd93f9>38</span>, <span style=color:#bd93f9>216</span>, <span style=color:#bd93f9>90</span>, <span style=color:#bd93f9>125</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20</span><span>                 <span style=color:#bd93f9>106</span>, <span style=color:#bd93f9>24</span>, <span style=color:#bd93f9>235</span>, <span style=color:#bd93f9>207</span>, <span style=color:#bd93f9>186</span>, <span style=color:#bd93f9>190</span>, <span style=color:#bd93f9>84</span>, <span style=color:#bd93f9>171</span>, <span style=color:#bd93f9>113</span>, <span style=color:#bd93f9>232</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>105</span>, <span style=color:#bd93f9>200</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21</span><span>                 <span style=color:#bd93f9>70</span>, <span style=color:#bd93f9>137</span>, <span style=color:#bd93f9>152</span>, <span style=color:#bd93f9>165</span>, <span style=color:#bd93f9>19</span>, <span style=color:#bd93f9>166</span>, <span style=color:#bd93f9>154</span>, <span style=color:#bd93f9>112</span>, <span style=color:#bd93f9>142</span>, <span style=color:#bd93f9>180</span>, <span style=color:#bd93f9>167</span>, <span style=color:#bd93f9>57</span>, <span style=color:#bd93f9>153</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22</span><span>                 <span style=color:#bd93f9>174</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>146</span>, <span style=color:#bd93f9>194</span>, <span style=color:#bd93f9>26</span>, <span style=color:#bd93f9>150</span>, <span style=color:#bd93f9>206</span>, <span style=color:#bd93f9>141</span>, <span style=color:#bd93f9>39</span>, <span style=color:#bd93f9>60</span>, <span style=color:#bd93f9>102</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>65</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23</span><span>                 <span style=color:#bd93f9>176</span>, <span style=color:#bd93f9>79</span>, <span style=color:#bd93f9>61</span>, <span style=color:#bd93f9>62</span>, <span style=color:#bd93f9>110</span>, <span style=color:#bd93f9>111</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>218</span>, <span style=color:#bd93f9>197</span>, <span style=color:#bd93f9>140</span>, <span style=color:#bd93f9>168</span>, <span style=color:#bd93f9>196</span>, <span style=color:#bd93f9>83</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24</span><span>                 <span style=color:#bd93f9>223</span>, <span style=color:#bd93f9>144</span>, <span style=color:#bd93f9>55</span>, <span style=color:#bd93f9>58</span>, <span style=color:#bd93f9>157</span>, <span style=color:#bd93f9>173</span>, <span style=color:#bd93f9>133</span>, <span style=color:#bd93f9>191</span>, <span style=color:#bd93f9>145</span>, <span style=color:#bd93f9>27</span>, <span style=color:#bd93f9>103</span>, <span style=color:#bd93f9>40</span>, <span style=color:#bd93f9>246</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25</span><span>                 <span style=color:#bd93f9>169</span>, <span style=color:#bd93f9>73</span>, <span style=color:#bd93f9>179</span>, <span style=color:#bd93f9>160</span>, <span style=color:#bd93f9>253</span>, <span style=color:#bd93f9>225</span>, <span style=color:#bd93f9>51</span>, <span style=color:#bd93f9>32</span>, <span style=color:#bd93f9>224</span>, <span style=color:#bd93f9>29</span>, <span style=color:#bd93f9>34</span>, <span style=color:#bd93f9>77</span>, <span style=color:#bd93f9>117</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26</span><span>                 <span style=color:#bd93f9>100</span>, <span style=color:#bd93f9>233</span>, <span style=color:#bd93f9>181</span>, <span style=color:#bd93f9>76</span>, <span style=color:#bd93f9>21</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>149</span>, <span style=color:#bd93f9>204</span>, <span style=color:#bd93f9>182</span>, <span style=color:#bd93f9>138</span>, <span style=color:#bd93f9>211</span>, <span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>231</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27</span><span>                 <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>238</span>, <span style=color:#bd93f9>254</span>, <span style=color:#bd93f9>252</span>, <span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>195</span>, <span style=color:#bd93f9>89</span>, <span style=color:#bd93f9>69</span>, <span style=color:#bd93f9>136</span>, <span style=color:#bd93f9>87</span>, <span style=color:#bd93f9>209</span>, <span style=color:#bd93f9>118</span>, <span style=color:#bd93f9>222</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28</span><span>                 <span style=color:#bd93f9>20</span>, <span style=color:#bd93f9>249</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>130</span>, <span style=color:#bd93f9>35</span>, <span style=color:#bd93f9>86</span>, <span style=color:#bd93f9>116</span>, <span style=color:#bd93f9>193</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>121</span>, <span style=color:#bd93f9>135</span>, <span style=color:#bd93f9>189</span>, <span style=color:#bd93f9>215</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29</span><span>                 <span style=color:#bd93f9>50</span>, <span style=color:#bd93f9>148</span>, <span style=color:#bd93f9>159</span>, <span style=color:#bd93f9>93</span>, <span style=color:#bd93f9>80</span>, <span style=color:#bd93f9>45</span>, <span style=color:#bd93f9>17</span>, <span style=color:#bd93f9>205</span>, <span style=color:#bd93f9>95</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30</span><span>                };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32</span><span><span style=color:#8be9fd>int</span> p[] <span style=color:#ff79c6>=</span> {<span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>15</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>11</span>, <span style=color:#bd93f9>14</span>};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34</span><span>uchar dbox[] <span style=color:#ff79c6>=</span> {<span style=color:#bd93f9>221</span>, <span style=color:#bd93f9>62</span>, <span style=color:#bd93f9>140</span>, <span style=color:#bd93f9>111</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>213</span>, <span style=color:#bd93f9>225</span>, <span style=color:#bd93f9>242</span>, <span style=color:#bd93f9>157</span>, <span style=color:#bd93f9>167</span>, <span style=color:#bd93f9>40</span>, <span style=color:#bd93f9>80</span>, <span style=color:#bd93f9>121</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35</span><span>                <span style=color:#bd93f9>83</span>, <span style=color:#bd93f9>93</span>, <span style=color:#bd93f9>64</span>, <span style=color:#bd93f9>219</span>, <span style=color:#bd93f9>253</span>, <span style=color:#bd93f9>123</span>, <span style=color:#bd93f9>147</span>, <span style=color:#bd93f9>234</span>, <span style=color:#bd93f9>212</span>, <span style=color:#bd93f9>49</span>, <span style=color:#bd93f9>115</span>, <span style=color:#bd93f9>131</span>, <span style=color:#bd93f9>35</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36</span><span>                <span style=color:#bd93f9>160</span>, <span style=color:#bd93f9>191</span>, <span style=color:#bd93f9>42</span>, <span style=color:#bd93f9>204</span>, <span style=color:#bd93f9>175</span>, <span style=color:#bd93f9>21</span>, <span style=color:#bd93f9>202</span>, <span style=color:#bd93f9>96</span>, <span style=color:#bd93f9>205</span>, <span style=color:#bd93f9>238</span>, <span style=color:#bd93f9>19</span>, <span style=color:#bd93f9>32</span>, <span style=color:#bd93f9>126</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37</span><span>                <span style=color:#bd93f9>164</span>, <span style=color:#bd93f9>193</span>, <span style=color:#bd93f9>36</span>, <span style=color:#bd93f9>41</span>, <span style=color:#bd93f9>46</span>, <span style=color:#bd93f9>76</span>, <span style=color:#bd93f9>252</span>, <span style=color:#bd93f9>31</span>, <span style=color:#bd93f9>69</span>, <span style=color:#bd93f9>116</span>, <span style=color:#bd93f9>23</span>, <span style=color:#bd93f9>247</span>, <span style=color:#bd93f9>201</span>, <span style=color:#bd93f9>84</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38</span><span>                <span style=color:#bd93f9>70</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>184</span>, <span style=color:#bd93f9>44</span>, <span style=color:#bd93f9>154</span>, <span style=color:#bd93f9>185</span>, <span style=color:#bd93f9>30</span>, <span style=color:#bd93f9>165</span>, <span style=color:#bd93f9>171</span>, <span style=color:#bd93f9>172</span>, <span style=color:#bd93f9>39</span>, <span style=color:#bd93f9>236</span>, <span style=color:#bd93f9>168</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39</span><span>                <span style=color:#bd93f9>57</span>, <span style=color:#bd93f9>79</span>, <span style=color:#bd93f9>24</span>, <span style=color:#bd93f9>228</span>, <span style=color:#bd93f9>143</span>, <span style=color:#bd93f9>107</span>, <span style=color:#bd93f9>100</span>, <span style=color:#bd93f9>196</span>, <span style=color:#bd93f9>63</span>, <span style=color:#bd93f9>109</span>, <span style=color:#bd93f9>211</span>, <span style=color:#bd93f9>206</span>, <span style=color:#bd93f9>95</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40</span><span>                <span style=color:#bd93f9>170</span>, <span style=color:#bd93f9>251</span>, <span style=color:#bd93f9>51</span>, <span style=color:#bd93f9>91</span>, <span style=color:#bd93f9>181</span>, <span style=color:#bd93f9>136</span>, <span style=color:#bd93f9>99</span>, <span style=color:#bd93f9>239</span>, <span style=color:#bd93f9>230</span>, <span style=color:#bd93f9>87</span>, <span style=color:#bd93f9>227</span>, <span style=color:#bd93f9>128</span>, <span style=color:#bd93f9>26</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41</span><span>                <span style=color:#bd93f9>50</span>, <span style=color:#bd93f9>250</span>, <span style=color:#bd93f9>6</span>, <span style=color:#bd93f9>255</span>, <span style=color:#bd93f9>106</span>, <span style=color:#bd93f9>117</span>, <span style=color:#bd93f9>108</span>, <span style=color:#bd93f9>90</span>, <span style=color:#bd93f9>208</span>, <span style=color:#bd93f9>124</span>, <span style=color:#bd93f9>166</span>, <span style=color:#bd93f9>192</span>, <span style=color:#bd93f9>43</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42</span><span>                <span style=color:#bd93f9>141</span>, <span style=color:#bd93f9>130</span>, <span style=color:#bd93f9>25</span>, <span style=color:#bd93f9>97</span>, <span style=color:#bd93f9>114</span>, <span style=color:#bd93f9>173</span>, <span style=color:#bd93f9>174</span>, <span style=color:#bd93f9>150</span>, <span style=color:#bd93f9>138</span>, <span style=color:#bd93f9>68</span>, <span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>240</span>, <span style=color:#bd93f9>207</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43</span><span>                <span style=color:#bd93f9>232</span>, <span style=color:#bd93f9>77</span>, <span style=color:#bd93f9>112</span>, <span style=color:#bd93f9>243</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>78</span>, <span style=color:#bd93f9>33</span>, <span style=color:#bd93f9>129</span>, <span style=color:#bd93f9>125</span>, <span style=color:#bd93f9>110</span>, <span style=color:#bd93f9>58</span>, <span style=color:#bd93f9>103</span>, <span style=color:#bd93f9>237</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44</span><span>                <span style=color:#bd93f9>104</span>, <span style=color:#bd93f9>18</span>, <span style=color:#bd93f9>188</span>, <span style=color:#bd93f9>28</span>, <span style=color:#bd93f9>244</span>, <span style=color:#bd93f9>229</span>, <span style=color:#bd93f9>144</span>, <span style=color:#bd93f9>217</span>, <span style=color:#bd93f9>122</span>, <span style=color:#bd93f9>178</span>, <span style=color:#bd93f9>163</span>, <span style=color:#bd93f9>151</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45</span><span>                <span style=color:#bd93f9>86</span>, <span style=color:#bd93f9>183</span>, <span style=color:#bd93f9>190</span>, <span style=color:#bd93f9>158</span>, <span style=color:#bd93f9>61</span>, <span style=color:#bd93f9>248</span>, <span style=color:#bd93f9>214</span>, <span style=color:#bd93f9>161</span>, <span style=color:#bd93f9>65</span>, <span style=color:#bd93f9>145</span>, <span style=color:#bd93f9>155</span>, <span style=color:#bd93f9>149</span>, <span style=color:#bd93f9>45</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46</span><span>                <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>186</span>, <span style=color:#bd93f9>92</span>, <span style=color:#bd93f9>249</span>, <span style=color:#bd93f9>198</span>, <span style=color:#bd93f9>48</span>, <span style=color:#bd93f9>59</span>, <span style=color:#bd93f9>22</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>146</span>, <span style=color:#bd93f9>148</span>, <span style=color:#bd93f9>153</span>, <span style=color:#bd93f9>179</span>, <span style=color:#bd93f9>195</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47</span><span>                <span style=color:#bd93f9>72</span>, <span style=color:#bd93f9>137</span>, <span style=color:#bd93f9>60</span>, <span style=color:#bd93f9>187</span>, <span style=color:#bd93f9>156</span>, <span style=color:#bd93f9>81</span>, <span style=color:#bd93f9>169</span>, <span style=color:#bd93f9>17</span>, <span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>197</span>, <span style=color:#bd93f9>152</span>, <span style=color:#bd93f9>210</span>, <span style=color:#bd93f9>216</span>, <span style=color:#bd93f9>54</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48</span><span>                <span style=color:#bd93f9>37</span>, <span style=color:#bd93f9>34</span>, <span style=color:#bd93f9>134</span>, <span style=color:#bd93f9>119</span>, <span style=color:#bd93f9>89</span>, <span style=color:#bd93f9>245</span>, <span style=color:#bd93f9>135</span>, <span style=color:#bd93f9>189</span>, <span style=color:#bd93f9>101</span>, <span style=color:#bd93f9>241</span>, <span style=color:#bd93f9>159</span>, <span style=color:#bd93f9>226</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49</span><span>                <span style=color:#bd93f9>180</span>, <span style=color:#bd93f9>177</span>, <span style=color:#bd93f9>98</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>142</span>, <span style=color:#bd93f9>52</span>, <span style=color:#bd93f9>15</span>, <span style=color:#bd93f9>71</span>, <span style=color:#bd93f9>215</span>, <span style=color:#bd93f9>254</span>, <span style=color:#bd93f9>162</span>, <span style=color:#bd93f9>133</span>, <span style=color:#bd93f9>56</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50</span><span>                <span style=color:#bd93f9>231</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>218</span>, <span style=color:#bd93f9>16</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>55</span>, <span style=color:#bd93f9>246</span>, <span style=color:#bd93f9>127</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>176</span>, <span style=color:#bd93f9>88</span>, <span style=color:#bd93f9>105</span>, <span style=color:#bd93f9>38</span>, <span style=color:#bd93f9>233</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51</span><span>                <span style=color:#bd93f9>182</span>, <span style=color:#bd93f9>203</span>, <span style=color:#bd93f9>200</span>, <span style=color:#bd93f9>74</span>, <span style=color:#bd93f9>66</span>, <span style=color:#bd93f9>73</span>, <span style=color:#bd93f9>53</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>220</span>, <span style=color:#bd93f9>139</span>, <span style=color:#bd93f9>209</span>, <span style=color:#bd93f9>118</span>, <span style=color:#bd93f9>132</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52</span><span>                <span style=color:#bd93f9>102</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>222</span>, <span style=color:#bd93f9>75</span>, <span style=color:#bd93f9>82</span>, <span style=color:#bd93f9>94</span>, <span style=color:#bd93f9>29</span>, <span style=color:#bd93f9>113</span>, <span style=color:#bd93f9>120</span>, <span style=color:#bd93f9>20</span>, <span style=color:#bd93f9>194</span>, <span style=color:#bd93f9>67</span>, <span style=color:#bd93f9>11</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53</span><span>                <span style=color:#bd93f9>235</span>, <span style=color:#bd93f9>47</span>, <span style=color:#bd93f9>27</span>, <span style=color:#bd93f9>224</span>, <span style=color:#bd93f9>199</span>, <span style=color:#bd93f9>223</span>, <span style=color:#bd93f9>85</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54</span><span>               };
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56</span><span><span style=color:#8be9fd>int</span> q[] <span style=color:#ff79c6>=</span> {<span style=color:#bd93f9>2</span>, <span style=color:#bd93f9>3</span>, <span style=color:#bd93f9>7</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>12</span>, <span style=color:#bd93f9>8</span>, <span style=color:#bd93f9>9</span>, <span style=color:#bd93f9>5</span>, <span style=color:#bd93f9>4</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>11</span>, <span style=color:#bd93f9>14</span>, <span style=color:#bd93f9>13</span>, <span style=color:#bd93f9>10</span>, <span style=color:#bd93f9>15</span>, <span style=color:#bd93f9>6</span>};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58</span><span><span style=color:#ff79c6>inline</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>mxor</span>(uchar<span style=color:#ff79c6>*</span> a, uchar<span style=color:#ff79c6>*</span> b, uchar<span style=color:#ff79c6>*</span> tmp) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60</span><span>        tmp[i] <span style=color:#ff79c6>=</span> a[i] <span style=color:#ff79c6>^</span> b[i];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64</span><span><span style=color:#ff79c6>inline</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>copy</span>(uchar<span style=color:#ff79c6>*</span> from, uchar<span style=color:#ff79c6>*</span> to) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66</span><span>        to[i] <span style=color:#ff79c6>=</span> from[i];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70</span><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>fun</span>(uchar<span style=color:#ff79c6>*</span> key, uchar<span style=color:#ff79c6>*</span> ct, uchar<span style=color:#ff79c6>*</span> tmp) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> ROUND_COUNT; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72</span><span>        mxor(ct, key, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73</span><span>        copy(tmp, ct);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74</span><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75</span><span>            ct[i] <span style=color:#ff79c6>=</span> sbox[ct[i]];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77</span><span>        uchar nct[BLOCK_LENGTH];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78</span><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79</span><span>            nct[i] <span style=color:#ff79c6>=</span> ct[p[i]];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81</span><span>        copy(nct, ct);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85</span><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>dec</span>(uchar<span style=color:#ff79c6>*</span> key, uchar<span style=color:#ff79c6>*</span> ct, uchar<span style=color:#ff79c6>*</span> tmp) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> ROUND_COUNT; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87</span><span>        uchar nct[BLOCK_LENGTH];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88</span><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89</span><span>            nct[i] <span style=color:#ff79c6>=</span> ct[q[i]];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91</span><span>        copy(nct, ct);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93</span><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> BLOCK_LENGTH; i<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94</span><span>            ct[i] <span style=color:#ff79c6>=</span> dbox[ct[i]];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96</span><span>        mxor(ct, key, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97</span><span>        copy(tmp, ct);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99</span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101</span><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>() {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102</span><span>    std<span style=color:#ff79c6>::</span>unordered_map<span style=color:#ff79c6>&lt;</span>std<span style=color:#ff79c6>::</span>string, std<span style=color:#ff79c6>::</span>string<span style=color:#ff79c6>&gt;</span> map;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103</span><span>    uchar<span style=color:#ff79c6>*</span> md5key <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> uchar[BLOCK_LENGTH];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104</span><span>    uchar tmp[BLOCK_LENGTH];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105</span><span>    uchar hexkey[] <span style=color:#ff79c6>=</span> {<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; i<span style=color:#ff79c6>++</span>) { <span style=color:#6272a4>// 爆破明文所有 key 加密的结果
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108</span><span><span style=color:#6272a4></span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; j<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109</span><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> k <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; k <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; k<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110</span><span>                uchar pt[] <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;16 bit plaintext&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111</span><span>                copy(MD5((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)hexkey, <span style=color:#bd93f9>3</span>).digest, md5key);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112</span><span>                fun(md5key, pt, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114</span><span>                std<span style=color:#ff79c6>::</span>string s1((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)pt, <span style=color:#bd93f9>16</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115</span><span>                std<span style=color:#ff79c6>::</span>string s2((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)hexkey, <span style=color:#bd93f9>3</span>);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117</span><span>                map[s1] <span style=color:#ff79c6>=</span> s2;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118</span><span>                hexkey[<span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120</span><span>            hexkey[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122</span><span>        std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> i <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123</span><span>        hexkey[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126</span><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; i<span style=color:#ff79c6>++</span>) { <span style=color:#6272a4>// 爆破密文所有 key 解密的结果, 如果在 map 中找到一样的, 用这两个 key 拿来解密 flag
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127</span><span><span style=color:#6272a4></span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; j<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128</span><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> k <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; k <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>256</span>; k<span style=color:#ff79c6>++</span>) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129</span><span>                uchar pt[] <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>\x04</span><span style=color:#f1fa8c>g</span><span style=color:#f1fa8c>\xa5</span><span style=color:#f1fa8c>*</span><span style=color:#f1fa8c>\xfa\x8f\x15\xcf\xb8\xf0\xea</span><span style=color:#f1fa8c>@6Zf</span><span style=color:#f1fa8c>\x92</span><span style=color:#f1fa8c>&#34;</span>; <span style=color:#6272a4>// &#34;0467a52afa8f15cfb8f0ea40365a6692&#34;.decode(&#39;hex&#39;)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130</span><span><span style=color:#6272a4></span>                copy(MD5((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)hexkey, <span style=color:#bd93f9>3</span>).digest, md5key);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131</span><span>                dec(md5key, pt, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133</span><span>                std<span style=color:#ff79c6>::</span>string s1((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)pt);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134</span><span>                <span style=color:#ff79c6>auto</span> ptr <span style=color:#ff79c6>=</span> map.find(s1);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136</span><span>                <span style=color:#ff79c6>if</span>(ptr <span style=color:#ff79c6>!=</span> map.end()) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137</span><span>                    std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#f1fa8c>&#34;Key found&#34;</span> <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138</span><span>                    uchar key[<span style=color:#bd93f9>3</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139</span><span>                    uchar flag[] <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>\x04\xb3</span><span style=color:#f1fa8c>NZ</span><span style=color:#f1fa8c>\xf4\xa1\xf5</span><span style=color:#f1fa8c>&amp;</span><span style=color:#f1fa8c>\x0f</span><span style=color:#f1fa8c>`C</span><span style=color:#f1fa8c>\xb8\xb9\xab\xb4\xf8</span><span style=color:#f1fa8c>&#34;</span>; <span style=color:#6272a4>// &#34;04b34e5af4a1f5260f6043b8b9abb4f8&#34;.decode(&#39;hex&#39;)
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140</span><span><span style=color:#6272a4></span>                    key[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> (<span style=color:#ff79c6>*</span>ptr).second.c_str()[<span style=color:#bd93f9>0</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141</span><span>                    key[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> (<span style=color:#ff79c6>*</span>ptr).second.c_str()[<span style=color:#bd93f9>1</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142</span><span>                    key[<span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>=</span> (<span style=color:#ff79c6>*</span>ptr).second.c_str()[<span style=color:#bd93f9>2</span>];
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143</span><span>                    copy(MD5((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)hexkey, <span style=color:#bd93f9>3</span>).digest, md5key);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144</span><span>                    dec(md5key, flag, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145</span><span>                    copy(MD5((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)key, <span style=color:#bd93f9>3</span>).digest, md5key);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146</span><span>                    dec(md5key, flag, tmp);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147</span><span>                    std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>string((<span style=color:#8be9fd>char</span><span style=color:#ff79c6>*</span>)flag, <span style=color:#bd93f9>16</span>) <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148</span><span>                    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149</span><span>                }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150</span><span>                hexkey[<span style=color:#bd93f9>2</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151</span><span>            }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152</span><span>            hexkey[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153</span><span>        }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154</span><span>        std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> i <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155</span><span>        hexkey[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156</span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157</span><span>    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158</span><span>}
</span></span></code></pre></div><p>其中 <code>dbox</code> 和 <code>q</code> 可以这样生成</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>dbox <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>0</span> <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(sbox))]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>q <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>0</span> <span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(p))]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(sbox)):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    dbox[sbox[i]] <span style=color:#ff79c6>=</span> i
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#ff79c6>for</span> i <span style=color:#ff79c6>in</span> <span style=color:#8be9fd;font-style:italic>range</span>(<span style=color:#8be9fd;font-style:italic>len</span>(p)):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>    q[p[i]] <span style=color:#ff79c6>=</span> i
</span></span></code></pre></div><p>大约需要 3g 内存和几分钟时间得到 flag<br>编译的时候别忘记带上 -O3</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>Key found
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>1337_1n_m1ddl38f
</span></span></code></pre></div><h2 id=总结>总结</h2><p>密码学博大精深, <code>Meet-in-the-middle</code> 只是其中一种攻击技术, 但其中的思路还是非常值得学习的,<br>有时候爆破不可避免, 我们能做的是如何让爆破最简化, 至少不那么暴力 233.</p><p>想要了解更多关于 <code>Meet-in-the-middle</code> 的知识可以去看对应的 <a href=https://en.wikipedia.org/wiki/Meet-in-the-middle_attack title rel="noopener nofollow noreferrer" target=_blank>WIKI</a></p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/writeup>writeup</a></li><li><a href=/tags/crypto>crypto</a></li></ul></nav></div></article></main><footer><div class=footer-info>© 2017 - 2023, rmb122</div><div style=display:flex><span class=border></span><a class=soc href=https://github.com/rmb122 title=GitHub><i data-feather=github></i></a><a class=soc href=https://rmb122.com/index.xml title=RSS><i data-feather=rss></i></a></div></footer><script>feather.replace()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1MH3QGWHV5"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1MH3QGWHV5",{anonymize_ip:!1})}</script><script src=https://rmb122.com/js/medium-zoom.min.js></script><script>for(let e of document.getElementsByTagName("img"))mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.8)"})</script></div></body></html>